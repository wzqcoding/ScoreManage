@using Models
@model List<EDU_EXAMINE_PAPER>

<div class="layui-card-body ">
    <table class="layui-table layui-form">
        <thead>
            <tr>

                <th>ID</th>
                <th>名称</th>
                <th>试卷描述</th>
                <th>关联考试</th>
                <th>状态</th>
                <th>操作</th>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>

                    <td>@item.ID</td>
                    <td>@item.NAME</td>
                    <td>@item.DESCRIPTION</td>
                    <td>@item.EXAM?.NAME</td>
                    <td class="td-status">
                        @if (item.ISENABLE == "1")
                        {
                            <span class="layui-btn layui-btn-normal layui-btn-mini">已启用</span>
                        }
                        else
                        {
                            <span class="layui-btn layui-btn-normal layui-btn-mini layui-btn-disabled">已停用</span>
                        }

                    </td>
                    <td class="td-manage">
                        @if (item.ISENABLE == "1")
                        {
                            <a onclick="member_stoporstart(this,@item.ID)" href="javascript:;" title="停用">
                                <i class="layui-icon">&#xe601;</i>
                            </a>
                        }
                        else
                        {
                            <a onclick="member_stoporstart(this,@item.ID)" href="javascript:;" title="启用">
                                <i class="layui-icon">&#xe62f;</i>
                            </a>
                        }
                        <a title="编辑" onclick="xadmin.open('编辑','/ExaminPaper/EditPaper?id='+@item.ID,500,300)" href="javascript:;">
                            <i class="layui-icon">&#xe642;</i>
                        </a>
                        <a onclick="xadmin.open('编写考题','/ExaminPaper/EditPaperQuestions?id='+@item.ID,800,600)" title="编写考题" href="javascript:;">
                            <i class="layui-icon">&#xe631;</i>
                        </a>
                    </td>
                </tr>
            }

        </tbody>
    </table>
</div>
<script>

    /*权限-停用-启用*/
    function member_stoporstart(obj, id) {
        var title = $(obj).attr('title');
        var confirmMsg = '确认要' + title + '吗？'
        var status = title == "停用" ? "0" : "1";
        layer.confirm(confirmMsg, function(index) {
            //发异步把用户状态进行更改
            $.post("/ExaminPaper/EnableOrDisAbledPaper", { "id": id, "status": status }, function(ret) {
                debugger;
                if (ret.Code == 0) {
                    if (status == "0") {
                        $(obj).attr('title', '启用')
                        $(obj).find('i').html('&#xe62f;');

                        $(obj).parents("tr").find(".td-status").find('span').addClass('layui-btn-disabled').html('已停用');
                        layer.msg('已停用!', { icon: 5, time: 1000 });

                    } else {
                        $(obj).attr('title', '停用')
                        $(obj).find('i').html('&#xe601;');

                        $(obj).parents("tr").find(".td-status").find('span').removeClass('layui-btn-disabled').html('已启用');
                        layer.msg('已启用!', { icon: 6, time: 1000 });
                    }
                } else {
                    layer.msg(ret.Message, { icon: 5, time: 1000 });
                }
            });


        });
    }

</script>
